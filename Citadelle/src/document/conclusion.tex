\part{Conclusion}

\chapter{Conclusion}

\section{Lessons Learned}
While our paper and pencil arguments, given
in~\cite{brucker.ea:ocl-null:2009}, turned out to be essentially
correct, there had also been a lesson to be learned: If the logic is
not defined as a Kleene-Logic, having a structure similar to a
\acf{cpo}, reasoning becomes complicated: several important algebraic laws break down
which makes reasoning in \OCL inherent messy and a semantically clean
compilation of \OCL formulae to a two-valued presentation, that is
amenable to animators like KodKod~\cite{torlak.ea:kodkod:2007} or
\acs{smt}-solvers like Z3~\cite{moura.ea:z3:2008} completely
impractical. Concretely, if the expression \inlineocl{not(null)}
is defined \inlineocl{invalid} (as is the case in the
present standard~\cite{omg:ocl:2012}), than standard involution does
not hold, \ie, \inlineocl{not(not(A))} = \inlineocl{A} does not hold
universally. Similarly, if
% \begin{ocl}
%      null and null  
% \end{ocl}
\inlineocl{null and null} is \inlineocl{invalid}, then not even
idempotence \inlineocl{X and X} = \inlineocl{X} holds. We strongly argue in favor of a lattice-like
organization, where \inlineocl{null} represents ``more information''
than \inlineocl{invalid} and the logical operators are monotone with
respect to this semantical ``information ordering.''
%(as in classical Scott \acs{cpo}'s).

Featherweight \OCL makes these two deviations from the standard,
builds all logical operators on Kleene-\inlineocl{not} and
Kleene-\inlineocl{and}, and shows that the entire construction of our
paper ``Extending \OCL with
Null-References''~\cite{brucker.ea:ocl-null:2009} is then correct, and
the \acs{dnf}-normaliation as well as $\delta$-closure laws (necessary
for a transition into a two-valued presentation of \OCL specifications
ready for interpretation in \acs{smt} solvers
(see~\cite{brucker.ea:ocl-testing:2010} for details) are valid in
Featherweight \OCL.

\section{Conclusion and Future Work}
Featherweight \OCL concentrates on formalizing the semantics of a core
subset of \OCL in general and in particular on formalizing the
consequences of a four-valued logic (\ie, \OCL versions that support,
besides the truth values \inlineocl{true} and \inlineocl{false} also
the two exception values \inlineocl{invalid} and \inlineocl{null}).

In the following, we outline the necessary steps for turning
Featherweight \OCL into a fully fledged tool for \OCL, \eg, similar to
\holocl as well as for supporting test case generation similar to
\acs{hol}-TestGen~\cite{brucker.ea:hol-testgen:2009}.  There are
essentially five extensions necessary:
\begin{itemize}
\item extension of  the library to support all \OCL data types, \eg,
  \inlineocl{Sequence(T)}, \inlineocl{OrderedSet(T)}. % This is
  % essentially a student-project given the sample proofs already there,
  % that have to be adapted to similar types.
  This formalization of the \OCL standard library can be used for
  checking the consistency of the formal semantics (known as ``Annex
  A'') with the informal and semi-formal requirements in the normative
  part of the \OCL standard.
\item development of a compiler that compiles a textual or \acs{case}
  tool representation (\eg, using \acs{xmi} or the textual syntax of
  the \acs{use} tool~\cite{richters:precise:2002}) of class
  models. Such compiler could also generate the necessary casts when
  converting standard \OCL to Featherweight \OCL as well as providing
  ``normalizations'' such as converting multiplicities of class
  attributes to into \OCL class invariants.
\item a setup for translating Featherweight \OCL into a two-valued
  representation as described
  in~\cite{brucker.ea:ocl-testing:2010}. As, in real-world scenarios,
  large parts of \acs{uml}/\acs{ocl} specifications are defined (\eg,
  from the default multiplicity \inlineocl{1} of an attributes
  \inlineocl{x}, we can directly infer that for all valid states
  \inlineocl{x} is neither \inlineocl{invalid} nor \inlineocl{null}),
  such a translation enables an efficient test case generation
  approach.
\item a setup in Featherweight \OCL of the Nitpick
  animator~\cite{blanchette.ea:nitpick:2010}. It remains to be shown
  that the standard, Kodkod~\cite{torlak.ea:kodkod:2007} based
  animator in Isabelle can give a similar quality of animation as the
  OCLexec Tool~\cite{krieger.ea:generative:2010}
\item a code-generator setup for Featherweight \OCL for Isabelle's
  code generator. For example, the Isabelle code generator supports
  the generation of F\#, which would allow to use \acs{ocl}
  specifications for testing arbitrary .net-based applications.
\end{itemize}
The first two extensions are sufficient to provide a formal proof
environment for \OCL 2.3 similar to \holocl while the remaining
extensions are geared towards increasing the degree of proof
automation and usability as well as providing a tool-supported test
methodology for \acs{uml}/\acs{ocl}.


Our work shows that developing a machine-checked formal semantics of
recent \acs{ocl} standards still reveals significant
inconsistencies---even though this type of research is not new. In
fact, we started our work already with the 1.x series of
\acs{ocl}. The reasons for this ongoing consistency problems of
\acs{ocl} standard are manifold. For example, the consequences of
adding an additional exception value to \OCL 2.2 are widespread across
the whole language and many of them are also quite subtle. Here, a
machine-checked formal semantics is of great value, as one is forced
to formalize all details and subtleties.  Moreover, the
standardization process of the \acs{omg}, in which standards (\eg, the
\acs{uml} infrastructure and the \acs{ocl} standard) that need to be
aligned closely are developed quite independently, are prone to ad-hoc
changes that attempt to align these standards. And, even worse,
updating a standard document by voting on the acceptance (or
rejection) of isolated text changes does not help either. Here, a tool
for the editor of the standard that helps to check the consistency of
the whole standard after each and every modifications can be of great
value as well.

